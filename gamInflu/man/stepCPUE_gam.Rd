% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stepCPUE_gam.R
\name{stepCPUE_gam}
\alias{stepCPUE_gam}
\title{Stepwise Model Selection for mgcv GAM Objects Using R-squared Criterion}
\usage{
stepCPUE_gam(
  object,
  scope,
  r2.change = 0.005,
  scale = 0,
  direction = c("both", "backward", "forward"),
  trace = 1,
  keep = deviance,
  steps = 1000,
  ...
)
}
\arguments{
\item{object}{An mgcv GAM object (fitted with \code{\link[mgcv]{gam}}).}

\item{scope}{Either a list with components \code{upper} and \code{lower} specifying the model scope,
or a single formula specifying the upper scope. If missing, backward selection only is performed.}

\item{r2.change}{Numeric. The minimum change in R-squared required to add or drop a term.
Default is 0.005.}

\item{scale}{Not used in GAM context, kept for compatibility. Default is 0.}

\item{direction}{Character string specifying the direction of selection:
"both" (default), "backward", or "forward".}

\item{trace}{Numeric. Controls the amount of output during selection:
\itemize{
  \item 0: No output
  \item 1: Basic progress output (default)
  \item 2: Detailed progress with R-squared values
  \item 3: Very detailed output with individual model fits
}}

\item{keep}{A function specifying what information to keep from each fitted model.
Default is \code{deviance}.}

\item{steps}{Maximum number of selection steps to perform. Default is 1000.}

\item{...}{Additional arguments passed to \code{\link[mgcv]{update.gam}}.}
}
\value{
An mgcv GAM object representing the final selected model, with an additional
\code{anova} component containing the stepwise selection path showing:
\itemize{
  \item Step: The term added or removed
  \item Df: Change in degrees of freedom
  \item Deviance: Change in deviance
  \item Resid. Df: Residual degrees of freedom
  \item Resid. Dev: Residual deviance
  \item r.squared: Model R-squared at each step
  \item aic: AIC value at each step
}
}
\description{
Performs stepwise model selection for mgcv GAM objects using R-squared change as the criterion.
This function is adapted for GAM objects and uses R-squared change rather than AIC for model selection.
It can perform forward, backward, or bidirectional stepwise selection.
}
\details{
This function adapts the stepwise selection procedure for mgcv GAM objects.
Unlike traditional AIC-based selection, this uses R-squared change as the criterion,
which can be more appropriate for GAMs where the effective degrees of freedom
may be difficult to determine precisely.

The R-squared is calculated as: (null.deviance - deviance) / null.deviance

For GAM objects, the function handles:
\itemize{
  \item Smooth terms (s(), te(), ti(), etc.)
  \item Parametric terms
  \item Random effects (s(..., bs="re"))
  \item Tensor products and interactions
}
}
\examples{
\dontrun{
library(mgcv)

# Create example data
set.seed(123)
n <- 200
dat <- data.frame(
  x1 = runif(n, 0, 10),
  x2 = runif(n, 0, 10),
  x3 = runif(n, 0, 10),
  f1 = factor(sample(1:3, n, replace = TRUE))
)
dat$y <- 2 + sin(dat$x1) + 0.5 * dat$x2 + as.numeric(dat$f1) + rnorm(n, 0, 0.5)

# Fit initial model
m1 <- gam(y ~ s(x1), data = dat)

# Define scope for stepwise selection
scope <- list(
  lower = ~ s(x1),
  upper = ~ s(x1) + s(x2) + s(x3) + f1
)

# Perform stepwise selection
m_step <- stepCPUE_gam(m1, scope = scope, r2.change = 0.01, trace = 2)

# View selection path
print(m_step$anova)
}

}
\seealso{
\code{\link[mgcv]{gam}}, \code{\link[mgcv]{update.gam}}, \code{\link[stats]{step}}
}
