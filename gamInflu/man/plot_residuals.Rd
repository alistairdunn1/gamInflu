% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_residuals.R
\name{plot_residuals}
\alias{plot_residuals}
\title{Residuals Plot}
\usage{
plot_residuals(
  obj,
  type = c("standard", "violin", "both"),
  residual_type = c("deviance", "pearson", "response", "working"),
  violin_trim = TRUE,
  add_boxplot = TRUE,
  by = NULL,
  ...
)
}
\arguments{
\item{obj}{A `gam_influence` object containing the fitted GAM model and data.}

\item{type}{Character. Type of residual plot to create:
- `"standard"`: Standard GAM residual plots (4-panel diagnostic plot)
- `"violin"`: Violin plot of residuals by focus term levels
- `"both"`: Both standard and violin plots (combined layout)}

\item{residual_type}{Character. Type of residuals to calculate:
- `"deviance"`: Deviance residuals (default, family-appropriate)
- `"pearson"`: Pearson residuals
- `"response"`: Response residuals (observed - fitted)
- `"working"`: Working residuals}

\item{violin_trim}{Logical. Should violin plots be trimmed to data range? Default is TRUE.}

\item{add_boxplot}{Logical. Should boxplots be overlaid on violin plots? Default is TRUE.}

\item{by}{Character. Optional variable name for faceting plots. If provided, creates separate
panels for each level of this variable. Must be a factor or character variable (not numeric).}

\item{...}{Additional arguments passed to ggplot2 functions.}
}
\value{
A ggplot object or patchwork object (for combined plots) showing:
  **Standard plots:**
  - Residuals vs fitted values
  - Q-Q plot of residuals
  - Scale-location plot (sqrt(|residuals|) vs fitted)
  - Residuals vs leverage (Cook's distance contours)

  **Violin plots:**
  - Distribution of residuals by focus term levels
  - Optional boxplots
}
\description{
Creates residual plots for GAM models with options for standard GAM residuals
and violin plots of residuals by focus term levels. Supports all GLM families and provides
comprehensive residual diagnostics.
}
\details{
**Residual Types:**
- **Deviance residuals**: Default choice, appropriate for all GLM families
- **Pearson residuals**: Standardised residuals, useful for checking variance assumptions
- **Response residuals**: Simple observed - fitted, interpretable but may not be appropriate for all families
- **Working residuals**: Used in iterative fitting, less commonly needed for diagnostics

**Family-specific behaviour:**
- **Gaussian**: All residual types available, deviance = Pearson for identity link
- **Binomial**: Deviance residuals recommended for binary data
- **Gamma**: Deviance residuals account for variance structure
- **Poisson**: Deviance residuals appropriate for count data
- **Tweedie**: Deviance residuals handle compound Poisson-Gamma structure

**Violin Plots:**
Show the full distribution of residuals within each level of the focus term,
revealing patterns that summary statistics might miss. If the focus term can be
converted to numeric (e.g., years stored as factors), the x-axis will display
as a numeric sequence for better readability.
}
\examples{
\dontrun{
# Basic usage - standard residual plots
gi <- gam_influence(your_model, focus = "year")
plot_residuals(gi, type = "standard")

# Violin plot of residuals by focus levels
plot_residuals(gi, type = "violin")

# Both plots combined
plot_residuals(gi, type = "both")

# Using different residual types
plot_residuals(gi, type = "violin", residual_type = "pearson")
plot_residuals(gi, type = "standard", residual_type = "response")

# Customised violin plot
plot_residuals(gi,
  type = "violin",
  add_boxplot = FALSE
)

# Numeric focus terms (e.g., years) will display as numeric sequence
gi_year <- gam_influence(your_model, focus = "year") # year as factor
plot_residuals(gi_year, type = "violin") # x-axis shows as 1990, 1991, 1992...

# Faceted plots by another variable
plot_residuals(gi, type = "violin", by = "gear_type")
plot_residuals(gi, type = "both", by = "area")

# For different model families
# Binomial model
plot_residuals(gi_binomial, type = "violin") # Shows residual patterns for binary data

# Gamma model
plot_residuals(gi_gamma, type = "standard") # Family-appropriate diagnostics
}
}
