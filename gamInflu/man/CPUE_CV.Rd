% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CPUE_CV.r
\name{CPUE_CV}
\alias{CPUE_CV}
\title{Estimate Additional CV for Smooth CPUE Trend}
\usage{
CPUE_CV(
  obj,
  r = 0.1,
  ylim = NULL,
  increase.only = FALSE,
  add.mean = TRUE,
  plot = TRUE
)
}
\arguments{
\item{obj}{A `gam_influence` object containing calculated indices from `calculate_influence()`.}

\item{r}{Numeric; maximum rate of population increase or change (as a proportion, default 0.1 or 10 percent).}

\item{ylim}{Numeric vector of length 2 specifying the y-axis limits. If NULL (default), calculated automatically.}

\item{increase.only}{Logical; if TRUE, only consider positive changes when selecting smoothing parameter.}

\item{add.mean}{Logical; if TRUE (default), add the smoothed trend line to the plot.}

\item{plot}{Logical; if TRUE (default), create a plot of the index with uncertainty. If FALSE, just return results without plotting.}
}
\value{
Invisibly returns a list containing:
  \itemize{
    \item `additional_CV`: The additional CV needed to achieve the smooth trend
    \item `total_CV`: Combined model CV and additional smoothing CV
    \item `data`: A data frame with the original indices, smoothed values,
          model CV, additional CV, and total CV
    \item `plot`: The ggplot object (if plot=TRUE)
  }
}
\description{
Estimates the additional coefficient of variation (CV) needed for a GAM-derived
standardized index series to follow a smooth trend. Uses a lognormal error model and
constrains the maximum rate of change between time points.
}
\details{
This function takes standardized indices from a GAM model and estimates the additional
process error (CV) needed to achieve a smoothed trend with constrained maximum rate of change.
This is useful for:
  \enumerate{
    \item Identifying excessive inter-annual variability in standardized indices
    \item Quantifying additional uncertainty needed for smoother stock assessment inputs
    \item Determining if a more constrained smoothing is biologically plausible
    \item Presenting smoothed indices with appropriate uncertainty bounds
  }

The CV is calculated assuming a lognormal error distribution, which is appropriate for
most fisheries abundance indices.
}
\examples{
\dontrun{
# First create and fit a gam_influence object
gi <- gam_influence(model, focus = "year")
gi <- calculate_influence(gi)

# Get process error CV with default settings
results <- CPUE_CV(gi)
cat("Additional CV needed:", results$additional_CV, "\n")

# With custom settings for maximum rate of change
results <- CPUE_CV(gi, r = 0.2, increase.only = TRUE)

# Without plotting
results <- CPUE_CV(gi, r = 0.15, plot = FALSE)
}
}
