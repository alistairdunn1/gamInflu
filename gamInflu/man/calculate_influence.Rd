% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_influence.R
\name{calculate_influence}
\alias{calculate_influence}
\alias{calculate_influence.gam_influence}
\title{Perform Influence Calculations}
\usage{
calculate_influence(
  obj,
  islog = NULL,
  rescale_method = c("auto", "geometric_mean", "arithmetic_mean", "raw", "custom"),
  custom_rescale_value = 1,
  confidence_level = 0.95,
  family = c("auto", "gaussian", "binomial", "gamma", "poisson"),
  subset_var = NULL,
  subset_value = NULL,
  separate_by_smooth = FALSE,
  ...
)

\method{calculate_influence}{gam_influence}(
  obj,
  islog = NULL,
  rescale_method = c("auto", "geometric_mean", "arithmetic_mean", "raw", "custom"),
  custom_rescale_value = 1,
  confidence_level = 0.95,
  family = c("auto", "gaussian", "binomial", "gamma", "poisson"),
  subset_var = NULL,
  subset_value = NULL,
  separate_by_smooth = FALSE,
  ...
)
}
\arguments{
\item{obj}{A \code{gam_influence} object.}

\item{islog}{Logical. Is the response variable log-transformed? If NULL (default), inferred from response name or model family.}

\item{rescale_method}{Character. How to rescale the indices. Options: "auto" (default), "geometric_mean", "arithmetic_mean", "raw", "custom".
\describe{
  \item{auto}{Uses sensible defaults based on model family and response transformation:
    \itemize{
      \item Binomial: "raw" (preserves probability scale 0-1)
      \item Gaussian with log-transformed response: "geometric_mean"
      \item Gaussian with original scale response: "arithmetic_mean"
      \item Gamma/Poisson: "geometric_mean" (appropriate for positive/count data)
    }
  }
  \item{geometric_mean}{Rescale relative to geometric mean (good for log-normal data)}
  \item{arithmetic_mean}{Rescale relative to arithmetic mean (good for normal data)}
  \item{raw}{No rescaling (preserves original scale)}
  \item{custom}{Rescale to custom value specified by custom_rescale_value}
}}

\item{custom_rescale_value}{Numeric. Custom rescaling value when rescale_method = "custom".}

\item{confidence_level}{Numeric. Confidence level for standardised index intervals (default 0.95).}

\item{family}{Character. How to handle different GLM families. Options: "auto" (default), "gaussian", "binomial", "gamma", "poisson".}

\item{subset_var}{Character. Name of variable to subset on (e.g., "area", "gear_type").}

\item{subset_value}{Value to subset by (e.g., "North", "Trawl"). If both subset_var and subset_value are provided, analysis is performed only on the subset, using the full model for predictions.}

\item{...}{Additional arguments (currently unused).}
}
\value{
The \code{gam_influence} object, now containing a \code{calculated} list with data frames for indices, summary stats, influences, predictions, and s.e. of predictions.
}
\description{
Perform calculations on a \code{gam_influence} object, including unstandardised and standardised indices, step-wise model building, and influence statistics. Supports subset-based analysis and multiple GLM families.
}
\details{
The function calculates unstandardised and standardised indices, confidence intervals, standard errors, and coefficients of variation (CV) using model predictions. For log-transformed data, calculations are performed in log space and exponentiated. Step-wise model building and influence statistics are also included.
}
\examples{
\dontrun{
data$year <- factor(data$year)
mod <- mgcv::gam(cpue ~ year + s(depth), data = data, family = Gamma(link = "log"))
gi <- gam_influence(mod, focus = "year")
gi <- calculate_influence(gi)
}
}
